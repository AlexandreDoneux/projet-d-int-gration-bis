import React, { useState, useEffect } from 'react';
import { Text, View, SafeAreaView } from 'react-native';
import { openDatabase } from 'react-native-sqlite-storage';


/*function drop_table(){
    database.run("DROP TABLE stockage_flux");
    database.run("DROP TABLE mot_enregistre");
    database.run("DROP TABLE amplitude_max");
}

function create_table(){
    database.run("CREATE TABLE IF NOT EXISTS mot_enregistre (id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, sample_enregistre TEXT);");
    database.run("CREATE TABLE IF NOT EXISTS amplitude_max (name TEXT PRIMARY KEY, valeur INTEGER);");
    database.run("CREATE TABLE IF NOT EXISTS stockage_flux (name TEXT PRIMARY KEY, sample_flux TEXT);");
}

function insert_table(){
    database.run("INSERT INTO stockage_flux (name, sample_flux) VALUES(?,?);", ['bubuu','[1,0,2]']);
    database.run("INSERT INTO amplitude_max (name, valeur) VALUES(?,?)", ['bubuu',3]);
    database.run("INSERT INTO mot_enregistre (name, sample_enregistre) VALUES(?,?)", ['bubuu','[1,0,2]']);
}*/


var db = openDatabase({ name: 'testdb.db3' });
const createTableMot = () => {
    db.transaction(function (txn) {
        txn.executeSql(
            "SELECT name FROM sqlite_master WHERE type='table' AND name='mot_enregistre'",
            [],
            function (tx, res) {
                console.log('item:', res.rows.length);
                if (res.rows.length == 0) {
                    txn.executeSql('DROP TABLE IF EXISTS mot_enregistre', []);
                    txn.executeSql('CREATE TABLE IF NOT EXISTS mot_enregistre (id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, sample_enregistre TEXT)', []);
                }
            }
        );
    })
    Alert.alert('SQLite Database and Table Successfully Created...');
};



const createTableAmp = () => {
    db.transaction(function (txn) {
        txn.executeSql(
            "SELECT name FROM sqlite_master WHERE type='table' AND name='amplitude_max'",
            [],
            function (tx, res) {
                console.log('item:', res.rows.length);
                if (res.rows.length == 0) {
                    txn.executeSql('DROP TABLE IF EXISTS amplitude_max', []);
                    txn.executeSql('CREATE TABLE IF NOT EXISTS amplitude_max (name TEXT PRIMARY KEY, valeur INTEGER);', []);
                }
            }
        );
    })
    Alert.alert('SQLite Database and Table Successfully Created...');
};




const insertDataMot = () => {

    db.transaction(function (tx) {
        tx.executeSql(
            'INSERT INTO mot_enregistre (name, sample_enregistre) VALUES (?,?)',
            ['la440', '0,3.2425055553903803;1,3.954172585511606;2,6.056693043160634;3,10.356703571289978;4,22.185440825203376;5,248.891045964652;6,32.55214515947999;7,16.272834885070974;8,11.170801817434231;9,8.640450794271619;10,7.111554910258791;11,6.0788040192928685;12,5.329386063402744;13,4.75781508096323;14,4.3056828536398095;15,3.937938104361456;16,3.6322130015446388;17,3.373526999775829;18,3.1514458006459285;19,2.9584641495326145;20,2.7890365899029987;21,2.638969456270426;22,2.5050272003312286;23,2.3846717173364884;24,2.275882010749634;25,2.1770254501331636;26,2.0867702599734463;27,2.004015401613709;28,1.9278437762024256;29,1.8574859712778962;30,1.7922878000796996;31,1.7316931418678525;32,1.6752232345558504;33,1.6224654069706497;34,1.5730604312957273;35,1.5266948409134808;36,1.4830932688597371;37,1.4420148389288083;38,1.4032431686371427;39,1.3665889635948494;40,1.3318824349993952;41,1.298971257451889;42,1.2677195211560575;43,1.2380040129885663;44,1.2097139769615874;45,1.1827502326350174;46,1.157020403684268;47,1.1324425962561897;48,1.108940961154698;49,1.0864471940407034;50,1.0648971278663135;51,1.0442336738155853;52,1.024404243717701;53,1.0053585457221714;54,0.9870515294461498;55,0.9694421604077493;56,0.9524908355132755;57,0.9361629419957234;58,0.9204254391583155;59,0.905245511297824;60,0.8905955900789368;61,0.8764491243551129;62,0.8627802613289137;63,0.8495661554016375;64,0.8367851430458109;65,0.824416490334024;66,0.8124419043210838;67,0.8008410299476983;68,0.7895985171472973;69,0.778699261736951;70,0.7681271793054868;71,0.7578686414582011;72,0.7479092101714321;73,0.7382384622456849;74,0.7288432289036929;75,0.7197114322116226;76,0.7108334437243299;77,0.7022003606139673;78,0.6938011545578512;79,0.6856267091836786;80,0.6776693683973466;81,0.6699199920286895;82,0.6623719733601868;83,0.655017325652499;84,0.6478495438487679;85,0.6408615362771449;86,0.6340468313130863;87,0.627399707455317;88,0.6209138761332711;89,0.6145858342793618;90,0.608407371750636;91,0.6023762106430468;92,0.5964851365629892;93,0.590731027521571;94,0.5851092562553868;95,0.5796155907388681;96,0.5742463222647903;97,0.5689973317597495;98,0.5638648432873848;99,0.5588449928701162;100,0.5539351395308346;101,0.5491313570081032;102,0.544430929157238;103,0.5398311733441078;104,0.5353287798584083;105,0.5309201237299903;106,0.5266046507523996;107,0.5223779729518154;108,0.518238439614453;109,0.5141835021011775;110,0.510210950433875;111,0.5063178529471518;112,0.5025035294215984;113,0.4987651310798478;114,0.49509984635876636;115,0.4915080130029639;116,0.48798475557139714;117,0.4845308223115656;118,0.4811436474763816;119,0.4778212520256623;120,0.47456255050631596;121,0.4713659321206337;122,0.4682296889452326;123,0.46515206776685986;124,0.46213236979865785;125,0.4591694508871563;126,0.4562606859570641;127,0.4534061012565331;128,0.45060383004316756;129,0.4478530411006568;130,0.44515246808658127;131,0.4425010140243114;132,0.43989705835457277;133,0.43734031617013025;134,0.43482986579130956;135,0.4323640815008983;136,0.429942159662693;137,0.42756381785229225;138,0.42522719864131137;139,0.4229325534070571;140,0.42067746592475047;141,0.4184627646668637;142,0.4162870499454637;143,0.41414904576736783;144,0.4120481146521775;145,0.4099843499682937;146,0.40795603740586356;147,0.4059636766227362;148,0.4040055841014465;149,0.4020812884388851;150,0.40019074704898094;151,0.3983320886491819;152,0.3965060491887147;153,0.3947114911125807;154,0.39294839931340264;155,0.39121522877475307;156,0.38951204648802823;157,0.38783851256032476;158,0.3861930602544989;159,0.38457667839362;160,0.3829881579821874;161,0.381427000402975;162,0.3798921981368917;163,0.3783849377300911;164,0.37690291571336887;165,0.3754472993547584;166,0.3740166711150433;167,0.3726105047635425;168,0.3712295656013093;169,0.3698723586659253;170,0.368538576342782;171,0.3672290153362687;172,0.3659422345284085;173,0.3646778090708605;174,0.3634362350885512;175,0.3622167341676142;176,0.3610187303720927;177,0.35984202157501943;178,0.35868685550367496;179,0.3575520678764781;180,0.3564383614216032;181,0.35534478140894205;182,0.35427093780714997;183,0.35321684743415926;184,0.3521825647761666;185,0.3511677536783737;186,0.35017160185597546;187,0.3491944076252926;188,0.3482358107285287;189,0.3472955720466158;190,0.3463730839960846;191,0.34546894425361274;192,0.3445823524610183;193,0.3437129043561342;194,0.3428607724740402;195,0.34202638208220654;196,0.34120871708338607;197,0.34040702054229693;198,0.3396225290812186;199,0.3388538319328162;200,0.3381022192120678;201,0.3373659112679344;202,0.33664543475415853;203,0.33594128650470184;204,0.33525245499147704;205,0.334578885446341;206,0.33392093865911765;207,0.3332779812266278;208,0.3326499534819028;209,0.3320370661544389;210,0.3314385333587202;211,0.3308548609518944;212,0.3302855890429034;213,0.32973034656021183;214,0.3291896265481376;215,0.32866304688138265;216,0.32815082552625335;217,0.3276521722242967;218,0.32716772580050624;219,0.3266966480677046;220,0.32623938217374665;221,0.32579569687286064;222,0.3253651159389279;223,0.324948753839066;224,0.3245450551503455;225,0.32415438482801673;226,0.3237771458390134;227,0.3234133284693753;228,0.3230619209649139;229,0.32272448786726926;230,0.32239871429004474;231,0.3220861625771342;232,0.32178588286490006;233,0.32149896995534294;234,0.3212245858012526;235,0.32096261113324476;236,0.32071265584418907;237,0.3204756474840698;238,0.320250857614439;239,0.3200390300706716;240,0.3198390206860735;241,0.31965178221446133;242,0.31947644667057506;243,0.3193132425954238;244,0.31916220517106025;245,0.3190235745732547;246,0.3188970324259609;247,0.31878290704069745;248,0.3186807382474012;249,0.3185900373773752;250,0.31851249482985217;251,0.31844641245208916;252,0.31839219738609276;253,0.31835012689768327;254,0.3183198622934846;255,0.31830161783944605;'],
            (tx, results) => {
                console.log('Results', results.rowsAffected);
                if (results.rowsAffected > 0) {
                    Alert.alert('Data Inserted Successfully....');
                } else Alert.alert('Failed....');
            }
        );
    });

    viewMot();

}

const insertDataAmp = () => {

    db.transaction(function (tx) {
        tx.executeSql(
            "INSERT INTO amplitude_max (name, valeur) VALUES(?,?)", ['bubuu', 3],
            (tx, results) => {
                console.log('Results', results.rowsAffected);
                if (results.rowsAffected > 0) {
                    Alert.alert('Data Inserted Successfully....');
                } else Alert.alert('Failed....');
            }
        );
    });

    viewAmp();

}



const viewMot = () => {

    db.transaction((tx) => {
        tx.executeSql(
            'SELECT sample_enregistre FROM mot_enregistre;',
            [],
            (tx, results) => {
                var temp = [];
                for (let i = 0; i < results.rows.length; ++i)
                    temp.push(results.rows.item(i));
                console.log(temp);
            }
        );
    });

}



const viewAmp = () => {

    db.transaction((tx) => {
        tx.executeSql(
            "SELECT valeur FROM amplitude_max WHERE name =='bubuu'",
            [],
            (tx, results) => {
                var temp = [];
                for (let i = 0; i < results.rows.length; ++i)
                    temp.push(results.rows.item(i));
                console.log(temp);
            }
        );
    });

}

const create_db = () => {
    console.log("create_DB")
}


/*
const getRecords = (sql) => {

    let recup = [];


    var database =  new sq.Database('./testdb.db', (err) => {
        if (err) {
          return console.error(err.message);
        }
        console.log('Connected to the in-memory SQlite database.');
    });

    return new Promise(resolve=>{
        database.all(sql,[],(err,rows)=>{
            if(err){
                return console.error(err.message);
            }
            rows.forEach((row)=>{
                recup.push(row);
                console.log(row.sample_flux);
            });

            resolve(recup);
        });
    });
}




const create_db = () => {
    getRecords("CREATE TABLE IF NOT EXISTS mot_enregistre (id INTEGER PRIMARY KEY AUTOINCREMENT, name TEXT, sample_enregistre TEXT)");
    getRecords("CREATE TABLE IF NOT EXISTS amplitude_max (name TEXT PRIMARY KEY, valeur INTEGER);");
    getRecords("INSERT INTO amplitude_max (name, valeur) VALUES(?,?)", ['bubuu',3]);
    getRecords("INSERT INTO mot_enregistre (name, sample_enregistre) VALUES(?,?)", ['la440','0,3.2425055553903803;1,3.954172585511606;2,6.056693043160634;3,10.356703571289978;4,22.185440825203376;5,248.891045964652;6,32.55214515947999;7,16.272834885070974;8,11.170801817434231;9,8.640450794271619;10,7.111554910258791;11,6.0788040192928685;12,5.329386063402744;13,4.75781508096323;14,4.3056828536398095;15,3.937938104361456;16,3.6322130015446388;17,3.373526999775829;18,3.1514458006459285;19,2.9584641495326145;20,2.7890365899029987;21,2.638969456270426;22,2.5050272003312286;23,2.3846717173364884;24,2.275882010749634;25,2.1770254501331636;26,2.0867702599734463;27,2.004015401613709;28,1.9278437762024256;29,1.8574859712778962;30,1.7922878000796996;31,1.7316931418678525;32,1.6752232345558504;33,1.6224654069706497;34,1.5730604312957273;35,1.5266948409134808;36,1.4830932688597371;37,1.4420148389288083;38,1.4032431686371427;39,1.3665889635948494;40,1.3318824349993952;41,1.298971257451889;42,1.2677195211560575;43,1.2380040129885663;44,1.2097139769615874;45,1.1827502326350174;46,1.157020403684268;47,1.1324425962561897;48,1.108940961154698;49,1.0864471940407034;50,1.0648971278663135;51,1.0442336738155853;52,1.024404243717701;53,1.0053585457221714;54,0.9870515294461498;55,0.9694421604077493;56,0.9524908355132755;57,0.9361629419957234;58,0.9204254391583155;59,0.905245511297824;60,0.8905955900789368;61,0.8764491243551129;62,0.8627802613289137;63,0.8495661554016375;64,0.8367851430458109;65,0.824416490334024;66,0.8124419043210838;67,0.8008410299476983;68,0.7895985171472973;69,0.778699261736951;70,0.7681271793054868;71,0.7578686414582011;72,0.7479092101714321;73,0.7382384622456849;74,0.7288432289036929;75,0.7197114322116226;76,0.7108334437243299;77,0.7022003606139673;78,0.6938011545578512;79,0.6856267091836786;80,0.6776693683973466;81,0.6699199920286895;82,0.6623719733601868;83,0.655017325652499;84,0.6478495438487679;85,0.6408615362771449;86,0.6340468313130863;87,0.627399707455317;88,0.6209138761332711;89,0.6145858342793618;90,0.608407371750636;91,0.6023762106430468;92,0.5964851365629892;93,0.590731027521571;94,0.5851092562553868;95,0.5796155907388681;96,0.5742463222647903;97,0.5689973317597495;98,0.5638648432873848;99,0.5588449928701162;100,0.5539351395308346;101,0.5491313570081032;102,0.544430929157238;103,0.5398311733441078;104,0.5353287798584083;105,0.5309201237299903;106,0.5266046507523996;107,0.5223779729518154;108,0.518238439614453;109,0.5141835021011775;110,0.510210950433875;111,0.5063178529471518;112,0.5025035294215984;113,0.4987651310798478;114,0.49509984635876636;115,0.4915080130029639;116,0.48798475557139714;117,0.4845308223115656;118,0.4811436474763816;119,0.4778212520256623;120,0.47456255050631596;121,0.4713659321206337;122,0.4682296889452326;123,0.46515206776685986;124,0.46213236979865785;125,0.4591694508871563;126,0.4562606859570641;127,0.4534061012565331;128,0.45060383004316756;129,0.4478530411006568;130,0.44515246808658127;131,0.4425010140243114;132,0.43989705835457277;133,0.43734031617013025;134,0.43482986579130956;135,0.4323640815008983;136,0.429942159662693;137,0.42756381785229225;138,0.42522719864131137;139,0.4229325534070571;140,0.42067746592475047;141,0.4184627646668637;142,0.4162870499454637;143,0.41414904576736783;144,0.4120481146521775;145,0.4099843499682937;146,0.40795603740586356;147,0.4059636766227362;148,0.4040055841014465;149,0.4020812884388851;150,0.40019074704898094;151,0.3983320886491819;152,0.3965060491887147;153,0.3947114911125807;154,0.39294839931340264;155,0.39121522877475307;156,0.38951204648802823;157,0.38783851256032476;158,0.3861930602544989;159,0.38457667839362;160,0.3829881579821874;161,0.381427000402975;162,0.3798921981368917;163,0.3783849377300911;164,0.37690291571336887;165,0.3754472993547584;166,0.3740166711150433;167,0.3726105047635425;168,0.3712295656013093;169,0.3698723586659253;170,0.368538576342782;171,0.3672290153362687;172,0.3659422345284085;173,0.3646778090708605;174,0.3634362350885512;175,0.3622167341676142;176,0.3610187303720927;177,0.35984202157501943;178,0.35868685550367496;179,0.3575520678764781;180,0.3564383614216032;181,0.35534478140894205;182,0.35427093780714997;183,0.35321684743415926;184,0.3521825647761666;185,0.3511677536783737;186,0.35017160185597546;187,0.3491944076252926;188,0.3482358107285287;189,0.3472955720466158;190,0.3463730839960846;191,0.34546894425361274;192,0.3445823524610183;193,0.3437129043561342;194,0.3428607724740402;195,0.34202638208220654;196,0.34120871708338607;197,0.34040702054229693;198,0.3396225290812186;199,0.3388538319328162;200,0.3381022192120678;201,0.3373659112679344;202,0.33664543475415853;203,0.33594128650470184;204,0.33525245499147704;205,0.334578885446341;206,0.33392093865911765;207,0.3332779812266278;208,0.3326499534819028;209,0.3320370661544389;210,0.3314385333587202;211,0.3308548609518944;212,0.3302855890429034;213,0.32973034656021183;214,0.3291896265481376;215,0.32866304688138265;216,0.32815082552625335;217,0.3276521722242967;218,0.32716772580050624;219,0.3266966480677046;220,0.32623938217374665;221,0.32579569687286064;222,0.3253651159389279;223,0.324948753839066;224,0.3245450551503455;225,0.32415438482801673;226,0.3237771458390134;227,0.3234133284693753;228,0.3230619209649139;229,0.32272448786726926;230,0.32239871429004474;231,0.3220861625771342;232,0.32178588286490006;233,0.32149896995534294;234,0.3212245858012526;235,0.32096261113324476;236,0.32071265584418907;237,0.3204756474840698;238,0.320250857614439;239,0.3200390300706716;240,0.3198390206860735;241,0.31965178221446133;242,0.31947644667057506;243,0.3193132425954238;244,0.31916220517106025;245,0.3190235745732547;246,0.3188970324259609;247,0.31878290704069745;248,0.3186807382474012;249,0.3185900373773752;250,0.31851249482985217;251,0.31844641245208916;252,0.31839219738609276;253,0.31835012689768327;254,0.3183198622934846;255,0.31830161783944605;']);
    return <div>hello</div>;
}
*/


export { createTableMot, createTableAmp, insertDataMot, insertDataAmp, viewMot, viewAmp, create_db };